name: ''
nodes:
- name: LentilsAnomalyDataNode
  class_name: cuvis_ai.node.data.LentilsAnomalyDataNode
  hparams:
    normal_class_ids:
    - 0
    - 1
- name: BandpassByWavelength
  class_name: cuvis_ai.node.preprocessors.BandpassByWavelength
  hparams:
    min_wavelength_nm: 700.0
    max_wavelength_nm: null
- name: PerPixelUnitNorm
  class_name: cuvis_ai.node.normalization.PerPixelUnitNorm
  hparams:
    eps: 1.0e-08
- name: ZScoreNormalizerGlobal
  class_name: cuvis_ai.anomaly.deep_svdd.ZScoreNormalizerGlobal
  hparams:
    num_channels: 27
    sample_n: 200000
    seed: 0
    eps: 1.0e-08
    hidden: 128
- name: DeepSVDDProjection
  class_name: cuvis_ai.anomaly.deep_svdd.DeepSVDDProjection
  hparams:
    in_channels: 27
    rep_dim: 32
    hidden: 128
    kernel: linear
    n_rff: 2048
    gamma: null
    mlp_forward_batch_size: 65536
- name: DeepSVDDCenterTracker
  class_name: cuvis_ai.anomaly.deep_svdd.DeepSVDDCenterTracker
  hparams:
    rep_dim: 32
    alpha: 0.1
    update_in_eval: false
- name: deepsvdd_loss
  class_name: cuvis_ai.node.losses.DeepSVDDSoftBoundaryLoss
  hparams:
    nu: 0.05
    weight: 1.0
- name: DeepSVDDScores
  class_name: cuvis_ai.anomaly.deep_svdd.DeepSVDDScores
  hparams:
    name: null
    execution_stages: null
- name: QuantileBinaryDecider
  class_name: cuvis_ai.deciders.binary_decider.QuantileBinaryDecider
  hparams:
    quantile: 0.995
    reduce_dims: null
- name: metrics_anomaly
  class_name: cuvis_ai.node.metrics.AnomalyDetectionMetrics
  hparams:
    execution_stages: null
- name: score_heatmap
  class_name: cuvis_ai.node.anomaly_visualization.ScoreHeatmapVisualizer
  hparams:
    normalize_scores: true
    cmap: inferno
    up_to: 5
- name: mask
  class_name: cuvis_ai.node.anomaly_visualization.AnomalyMask
  hparams:
    channel: 30
    up_to: 5
- name: TensorBoardMonitorNode
  class_name: cuvis_ai.node.monitor.TensorBoardMonitorNode
  hparams:
    output_dir: outputs\deepsvdd\..\tensorboard
    run_name: DeepSVDD_Gradient
    comment: ''
    flush_secs: 120
connections:
- source: LentilsAnomalyDataNode.outputs.cube
  target: BandpassByWavelength.inputs.data
- source: LentilsAnomalyDataNode.outputs.wavelengths
  target: BandpassByWavelength.inputs.wavelengths
- source: LentilsAnomalyDataNode.outputs.mask
  target: metrics_anomaly.inputs.targets
- source: LentilsAnomalyDataNode.outputs.mask
  target: mask.inputs.mask
- source: LentilsAnomalyDataNode.outputs.cube
  target: mask.inputs.cube
- source: BandpassByWavelength.outputs.filtered
  target: PerPixelUnitNorm.inputs.data
- source: PerPixelUnitNorm.outputs.normalized
  target: ZScoreNormalizerGlobal.inputs.data
- source: ZScoreNormalizerGlobal.outputs.normalized
  target: DeepSVDDProjection.inputs.data
- source: DeepSVDDProjection.outputs.embeddings
  target: DeepSVDDCenterTracker.inputs.embeddings
- source: DeepSVDDProjection.outputs.embeddings
  target: deepsvdd_loss.inputs.embeddings
- source: DeepSVDDProjection.outputs.embeddings
  target: DeepSVDDScores.inputs.embeddings
- source: DeepSVDDCenterTracker.outputs.center
  target: deepsvdd_loss.inputs.center
- source: DeepSVDDCenterTracker.outputs.center
  target: DeepSVDDScores.inputs.center
- source: DeepSVDDCenterTracker.outputs.metrics
  target: TensorBoardMonitorNode.inputs.metrics
- source: DeepSVDDScores.outputs.scores
  target: QuantileBinaryDecider.inputs.logits
- source: DeepSVDDScores.outputs.scores
  target: metrics_anomaly.inputs.logits
- source: DeepSVDDScores.outputs.scores
  target: score_heatmap.inputs.scores
- source: DeepSVDDScores.outputs.scores
  target: mask.inputs.scores
- source: QuantileBinaryDecider.outputs.decisions
  target: metrics_anomaly.inputs.decisions
- source: QuantileBinaryDecider.outputs.decisions
  target: mask.inputs.decisions
- source: metrics_anomaly.outputs.metrics
  target: TensorBoardMonitorNode.inputs.metrics
- source: score_heatmap.outputs.artifacts
  target: TensorBoardMonitorNode.inputs.artifacts
- source: mask.outputs.artifacts
  target: TensorBoardMonitorNode.inputs.artifacts
metadata:
  name: DeepSVDD_Gradient
  description: Trained model from DeepSVDD_Gradient trainrun (statistical + gradient
    training)
  created: ''
  tags:
  - gradient
  - statistical
  - deep_svdd
  - anomaly_detection
  author: cuvis.ai
  cuvis_ai_version: 0.1.5.post30+g6d28af5c2.d20251217
