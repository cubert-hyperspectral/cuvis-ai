metadata:
  name: Channel_Selector
  description: Trained model from Channel_Selector experiment (statistical + gradient
    training)
  created: ''
  tags:
  - gradient
  - statistical
  - channel_selector
  - rx
  author: cuvis.ai
nodes:
- name: LentilsAnomalyDataNode
  class_name: cuvis_ai.node.data.LentilsAnomalyDataNode
  hparams:
    normal_class_ids:
    - 0
    - 1
- name: MinMaxNormalizer
  class_name: cuvis_ai.node.normalization.MinMaxNormalizer
  hparams:
    eps: 1.0e-06
    use_running_stats: true
- name: SoftChannelSelector
  class_name: cuvis_ai.node.selector.SoftChannelSelector
  hparams:
    n_select: 3
    input_channels: 61
    init_method: variance
    temperature_init: 5.0
    temperature_min: 0.1
    temperature_decay: 0.9
    hard: false
    eps: 1.0e-06
- name: RXGlobal
  class_name: cuvis_ai.anomaly.rx_detector.RXGlobal
  hparams:
    eps: 1.0e-06
    num_channels: 61
    cache_inverse: true
- name: ScoreToLogit
  class_name: cuvis_ai.node.conversion.ScoreToLogit
  hparams:
    init_scale: 1.0
    init_bias: 0.0
- name: bce
  class_name: cuvis_ai.node.losses.AnomalyBCEWithLogits
  hparams:
    weight: 10.0
    pos_weight: null
    reduction: mean
- name: entropy
  class_name: cuvis_ai.node.losses.SelectorEntropyRegularizer
  hparams:
    weight: 0.1
    target_entropy: null
    eps: 1.0e-06
- name: diversity
  class_name: cuvis_ai.node.losses.SelectorDiversityRegularizer
  hparams:
    weight: 0.01
- name: BinaryDecider
  class_name: cuvis_ai.deciders.binary_decider.BinaryDecider
  hparams:
    threshold: 0.5
- name: metrics_anomaly
  class_name: cuvis_ai.node.metrics.AnomalyDetectionMetrics
  hparams:
    execution_stages: null
- name: TensorBoardMonitorNode
  class_name: cuvis_ai.node.monitor.TensorBoardMonitorNode
  hparams:
    output_dir: outputs\channel_selector\..\tensorboard
    run_name: Channel_Selector
    comment: ''
    flush_secs: 120
- name: mask
  class_name: cuvis_ai.node.visualizations.AnomalyMask
  hparams:
    channel: 30
    up_to: 5
- name: rgb
  class_name: cuvis_ai.node.visualizations.CubeRGBVisualizer
  hparams:
    name: null
    up_to: 5
connections:
- source: LentilsAnomalyDataNode.outputs.cube
  target: MinMaxNormalizer.inputs.data
- source: LentilsAnomalyDataNode.outputs.mask
  target: bce.inputs.targets
- source: LentilsAnomalyDataNode.outputs.mask
  target: metrics_anomaly.inputs.targets
- source: LentilsAnomalyDataNode.outputs.mask
  target: mask.inputs.mask
- source: LentilsAnomalyDataNode.outputs.cube
  target: mask.inputs.cube
- source: LentilsAnomalyDataNode.outputs.cube
  target: rgb.inputs.cube
- source: LentilsAnomalyDataNode.outputs.wavelengths
  target: rgb.inputs.wavelengths
- source: MinMaxNormalizer.outputs.normalized
  target: SoftChannelSelector.inputs.data
- source: SoftChannelSelector.outputs.selected
  target: RXGlobal.inputs.data
- source: SoftChannelSelector.outputs.weights
  target: entropy.inputs.weights
- source: SoftChannelSelector.outputs.weights
  target: diversity.inputs.weights
- source: SoftChannelSelector.outputs.weights
  target: rgb.inputs.weights
- source: RXGlobal.outputs.scores
  target: ScoreToLogit.inputs.scores
- source: ScoreToLogit.outputs.logits
  target: bce.inputs.predictions
- source: ScoreToLogit.outputs.logits
  target: BinaryDecider.inputs.logits
- source: BinaryDecider.outputs.decisions
  target: metrics_anomaly.inputs.decisions
- source: BinaryDecider.outputs.decisions
  target: mask.inputs.decisions
- source: metrics_anomaly.outputs.metrics
  target: TensorBoardMonitorNode.inputs.metrics
- source: mask.outputs.artifacts
  target: TensorBoardMonitorNode.inputs.artifacts
- source: rgb.outputs.artifacts
  target: TensorBoardMonitorNode.inputs.artifacts
